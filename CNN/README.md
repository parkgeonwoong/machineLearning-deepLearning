# 📌 이미지 인식 CNN

## 🔥 데이터 전처리

- MNIST 데이터란 필기 숫자의 분류를 위한 학습 데이터 집합.
- MNIST 데이터는 케라스를 이용해 간단히 불러올 수 있다.

```python
from keras.datasets import mnist
```

- 2차원 배열을 1차원 배열로 바꿔 주는 reshape(총 샘플 수, 1차원 속성의 수) 함수를 사용

<p>

- 정규화 (normalization)

  - 데이터의 폭이 클 때 적절한 값으로 분산의 정도를 바꾸는 과정

  - 0~255 정수를 255로 나누어 0~1 사이의 값으로 바꿈

<br>

## 🔥 컨볼루션 신경망(CNN)

- 딥러닝 프레임에 이미지 인식 분야에서 강력한 성능을 보임

- 입력된 이미지에서 다시 한번 특징을 추출하기 위해 커널을 도입하는 기법

- CNN은 이미지/영상 인식에서 주로 사용되는 신경망

<br>

- 다차원 배열 데이터를 처리하도록 구성되어 컬러 이미지 같은 다차원 배열 처리에 특화되어 있으며, 다음과 같은 계층 들로 구성

  1. 입력층
  2. 합성곱층
  3. 풀링층
  4. 완전 연결층
  5. 출력층

<p>

- 합성곱층과 풀링층을 거치면서 특징 벡터를 추출함
- 완전연결층을 거치면서 1차원 벡터로 변환
- 출력층에서 활성화 함수인 소프트맥스 함수를 사용해 최종 결과

<br>

#### 합성곱층

- 입력 데이터에서 특징을 추출하는 역할 수행
- 이미지에 대한 특징을 감지하기 위해 필터를 사용
- 모든 영역을 훑으면서 특징을 추출하게 되는데, 이렇게 추출된 결과물이 특징 맵

<p>

- 컨벌루션은 입력이미지의 인접한 화소값들에 필터값을 곱해서 더한 후에 이것을 새로운 화소값으로 하는 연산

<p>

- 보폭(stride)
  - 필터를 적용하는 거리
  - 보폭 = 1 → 1픽셀씩 이동하면서 필터를 적용하는 것

<p>

- 패딩
  - 이미지의 가장자리를 처리하기 위한 기법
  - Valid : 커널을 입력 이미지 안에서만 움직임
  - Same : 입력 이미지를 채우는 것

<p>

- 새롭게 만들어진 층을 컨볼루션 이라고 부름
- 이러한 필터를 여러 개 만들 경우 여러 개의 컨볼루션이 만들어짐
- 필터를 여러 개 사용하면 이미지의 다양한 특징들을 학습할 수 있고, 정교한 특징 추출

<p>

- 케라스 에서 컨볼루션 층을 추가하는 함수 Conv2D()

```python
model.add(Conv2D(32, kernel_size=(3, 3), input_shape=(28, 28, 1), activation='relu'))
```

<br>

## 🔥 맥스 풀링

- 풀링

  - 컨볼루션 층에서 이미지 특징 도출하지만 여전히 크고, 복잡하면 다시 축소

- 맥스풀링

  - 정해진 구역 안에서 최댓값을 뽑아내는 것

```python
model.add(MaxPooling2D(pool_size=2))
```

<p>

- 드롭 아웃
  - 은닉층에 배치되 노드 중 일부를 임의로 꺼주는 것
  - 랜덤하게 노드를 끔으로써 학습 데이터에 지나치게 치우쳐서 학습되는 과적합을 방지할 수 있음

```python
model.add(Dropout(0.25))
```
